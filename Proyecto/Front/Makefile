# Variables
COMPOSE_FILE=docker-compose.yml

# Target de ayuda por defecto
help:
	@echo "游냡 Makefile para gesti칩n de proyectos Docker 游냡"
	@echo ""
	@echo "Ordenes disponibles:"
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | sort | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-20s\033[0m %s\n", $$1, $$2}'

build: ## Construcci칩n de servicios Docker
	@echo 'Construcci칩n de servicios'
	docker-compose build

up: ## Levantar servicios en modo detach
	@echo 'Levantando servicios'
	docker-compose up -d

down: ## Detener y eliminar contenedores
	@echo 'Deteniendo servicios'
	docker-compose down

restart: ## Reiniciar todos los servicios
	@echo 'Reiniciando servicios'
	docker-compose restart

logs: ## Mostrar logs en tiempo real
	@echo 'Mostrando logs'
	docker-compose logs -f

clean: ## Eliminar contenedores, im치genes y vol칰menes
	@echo 'Limpiando recursos de Docker'
	docker-compose down -v --rmi all
	docker rmi node:18-alpine


start: ## Levanta el proyecto directamente.
	$(MAKE) build
	$(MAKE) up
	$(MAKE) logs

close_all: ## Cierra todo el proyecto y elimina imagenes
	$(MAKE) down
	$(MAKE) clean


# Target por defecto
.DEFAULT_GOAL := help